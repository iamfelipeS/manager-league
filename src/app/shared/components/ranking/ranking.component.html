<div class="p-4">
  <h2 class="text-xl font-semibold mb-4">Classificação Atual</h2>

  <!-- Critérios Editáveis -->
  @if (isAdmin()) {
    <div class="mb-6">
      <h3 class="text-lg font-medium mb-2">Critérios de Pontuação</h3>
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
        @for (criterio of criterios(); track criterio.id) {
          <div class="bg-white p-4 rounded shadow border space-y-2">
            <input
              class="w-full border px-3 py-1 rounded"
              [(ngModel)]="criterio.nome"
              [readonly]="criterio.nome === 'Pontos'"
            />
            <div class="flex justify-between gap-2">
              <input
                type="number"
                class="w-1/2 border px-2 py-1 rounded"
                [(ngModel)]="criterio.prioridade"
                placeholder="Prioridade"
              />
              <input
                type="number"
                class="w-1/2 border px-2 py-1 rounded"
                [(ngModel)]="criterio.peso"
                placeholder="Peso"
              />
            </div>
          </div>
        }
      </div>
      <button
        (click)="salvarCriterios()"
        class="mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition"
      >
        Salvar Critérios
      </button>
    </div>
  }

  <!-- Tabela de Classificação -->
  <div class="overflow-x-auto">
    <table class="w-full table-auto text-sm border">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-4 py-2 text-left">#</th>
          <th class="px-4 py-2 text-left">Jogador</th>
          @for (criterio of criterios(); track criterio.id) {
            <th class="px-4 py-2 text-left capitalize">{{ criterio.nome }}</th>
          }
          @if (isAdmin()) {
            <th class="px-4 py-2">Pontua?</th>
          }
        </tr>
      </thead>
      <tbody>
        @for (player of ordenarJogadores(); track player.id) {
          <tr [class.opacity-40]="!player.pontua" class="border-b">
            <td class="px-4 py-2">{{ $index + 1 }}</td>
            <td class="px-4 py-2 font-medium">{{ player.name }}</td>
            @for (criterio of criterios(); track criterio.id) {
                <td class="px-4 py-2">
                {{ getValor(player, criterio.nome.toLowerCase()) }}
                </td>
            }
            @if (isAdmin()) {
              <td class="px-4 py-2 text-center">
                <input
                  type="checkbox"
                  [(ngModel)]="player.pontua"
                  (change)="togglePontua(player)"
                />
              </td>
            }
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>
