<div class="p-4">
  <h2 class="text-xl font-semibold mb-4 text-center">Classifica√ß√£o Atual</h2>

  <!-- Crit√©rios Edit√°veis -->
  @if (isAdmin()) {
  <div class="mb-6">
    <h3 class="text-lg font-medium mb-2">Crit√©rios de Pontua√ß√£o</h3>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
      @for (criterio of criterios(); track criterio.id) {
      <div class="bg-white p-4 rounded shadow border space-y-2">
        <input class="w-full border px-3 py-1 rounded" [(ngModel)]="criterio.nome"
          [readonly]="criterio.nome === 'Pontos'" />
        <div class="flex justify-between gap-2">
          <input type="number" class="w-1/2 border px-2 py-1 rounded" [(ngModel)]="criterio.prioridade"
            placeholder="Prioridade" />
          <input type="number" class="w-1/2 border px-2 py-1 rounded" [(ngModel)]="criterio.peso" placeholder="Peso" />
        </div>
      </div>
      }
    </div>
    <button (click)="salvarCriterios()"
      class="mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">
      Salvar Crit√©rios
    </button>
  </div>
  }

  <!-- Tabela de Classifica√ß√£o -->
  <div class="overflow-x-auto">
    <table class="w-full table-auto text-sm border">
      <thead class="bg-gray-100 text-left">
        <tr>
          <th class="px-4 py-2">#</th>
          <th class="px-4 py-2">Jogador</th>
          @for (criterio of criterios(); track criterio.id) {
          <th class="px-4 py-2 capitalize">{{ criterio.nome }}</th>
          }
          <th class="px-4 py-2">Trof√©us</th>
          @if (isAdmin()) {
          <th class="px-4 py-2 text-center">Pontua?</th>
          }
        </tr>
      </thead>
      <tbody>
        @for (player of ordenarJogadores(); track player.id; let i = $index) {
        <tr>
          <td>
            @if (i === 0) { ü•á } @else if (i === 1) { ü•à } @else if (i === 2) { ü•â } @else { {{ i + 1 }} }
          </td>
          <td class="px-4 py-2 flex items-center gap-3">
            <img [src]="player.avatarUrl || 'icons/user.png'" class="w-8 h-8 rounded-full object-cover" />
            <span class="truncate max-w-[140px]">{{ player.name }}</span>
          </td>
          @for (criterio of criterios(); track criterio.id) {
          <td class="px-4 py-2">
            {{ getValor(player, criterio.nome.toLowerCase()) }}
          </td>
          }
          <td class="px-4 py-2">
            @if (player.trofeus && player.trofeus > 0) {
            <span class="flex items-center gap-1 text-yellow-600">
              <i class="fas fa-trophy"></i>
              @if (player.trofeus > 1) {
              <span class="text-xs">x{{ player.trofeus }}</span>
              }
            </span>
            } @else {
            <span>-</span>
            }
          </td>

          @if (isAdmin()) {
          <td class="px-4 py-2 text-center">
            <input type="checkbox" [(ngModel)]="player.pontua" (change)="togglePontua(player)" />
          </td>
          }
        </tr>
        }
      </tbody>
    </table>
  </div>
</div>